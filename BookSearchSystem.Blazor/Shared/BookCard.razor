@using BookSearchSystem.Blazor.Models
@inject NavigationManager Navigation

<MudCard Elevation="2" Class="book-card">
    <MudCardMedia Image="@(Book.CoverUrl ?? "https://via.placeholder.com/200x300?text=No+Cover")" 
                  Height="200" />
    <MudCardContent>
        <MudText Typo="Typo.h6" Class="mb-2">@Book.Title</MudText>
        <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mb-1">
            <MudIcon Icon="@Icons.Material.Filled.Person" Size="Size.Small" /> @Book.Author
        </MudText>
        <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mb-2">
            <MudIcon Icon="@Icons.Material.Filled.Category" Size="Size.Small" /> @Book.Category
        </MudText>
        
        <MudDivider Class="my-2" />
        
        <div class="d-flex justify-space-between align-center">
            <MudText Typo="Typo.h6" Color="Color.Primary">
                ¥@Book.Price.ToString("F2")
            </MudText>
            <MudChip T="string" 
                     Color="@(Book.Stock > 0 ? Color.Success : Color.Error)" 
                     Size="Size.Small"
                     Icon="@Icons.Material.Filled.Inventory">
                @(Book.Stock > 0 ? $"库存: {Book.Stock}" : "缺货")
            </MudChip>
        </div>
    </MudCardContent>
    
    <MudCardActions>
        <MudButton Variant="Variant.Text" 
                   Color="Color.Primary" 
                   OnClick="ViewDetails"
                   StartIcon="@Icons.Material.Filled.Info">
            查看详情
        </MudButton>
        <MudIconButton Icon="@Icons.Material.Filled.Favorite" 
                       Color="Color.Secondary"
                       OnClick="AddToFavorites" />
    </MudCardActions>
</MudCard>

@code {
    [Parameter]
    public Book Book { get; set; } = null!;
    
    [Parameter]
    public EventCallback<int> OnAddToFavorites { get; set; }
    
    private void ViewDetails()
    {
        Navigation.NavigateTo($"/book/{Book.BookId}");
    }
    
    private async Task AddToFavorites()
    {
        await OnAddToFavorites.InvokeAsync(Book.BookId);
    }
}
